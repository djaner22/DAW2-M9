/* uglify - 2020-11-02 09:11:52 - */
var oLastSeenProduct;$(document).ready(function(){oLastSeenProduct=new LastSeenProduct}),EventBus.subscribe("addLastSeenProductFromProductPage","onAddLastSeenProductFromProductPage",function(e){var t=oLastSeenProduct._generateDataProductPage(e.datas,e.productRefco,e.productBV);oLastSeenProduct._generateLastSeenProducts(t)}),EventBus.subscribe("removeProductInLastSeenCookie","onRemoveProductInLastSeenCookie",function(e){oLastSeenProduct._removeLastSeenProduct(e.refco),void 0!==e.productToRemove&&e.productToRemove.parent().remove()}),LastSeenProduct=function(){var e={__TIME_TO_KEEP_PRODUCT__:15,__MAX_LAST_SEEN_PRODUCT__:6,__HD_PICTURE_PATTERN__:"",__SD_PICTURE_PATTERN__:"_pr1.",_init:function(){return this._removeExpiresLastSeenProduct(),this},_generateDataProductPage:function(){},_generateLastSeenProducts:function(t){var e,r,a=new Date;a.setDate(a.getDate()+this.__TIME_TO_KEEP_PRODUCT__),t.expireDate=a,!1===localStorageHandler.exists(localStorageHandler.LAST_SEEN_PRODUCT_STORAGE)?((e=[]).push(t),localStorageHandler.setObject(localStorageHandler.LAST_SEEN_PRODUCT_STORAGE,e)):0===(r=localStorageHandler.getObject(localStorageHandler.LAST_SEEN_PRODUCT_STORAGE)).filter(function(e){if(e.refco===t.refco)return!0}).length&&(r.unshift(t),r.length>this.__MAX_LAST_SEEN_PRODUCT__&&r.pop(),localStorageHandler.setObject(localStorageHandler.LAST_SEEN_PRODUCT_STORAGE,r))},_removeLastSeenProduct:function(a){var e;!0===localStorageHandler.exists(localStorageHandler.LAST_SEEN_PRODUCT_STORAGE)&&((e=localStorageHandler.getObject(localStorageHandler.LAST_SEEN_PRODUCT_STORAGE)).forEach(function(e,t,r){e.refco===a&&r.splice(t,1)}),0!==e.length?localStorageHandler.setObject(localStorageHandler.LAST_SEEN_PRODUCT_STORAGE,e):localStorageHandler.remove(localStorageHandler.LAST_SEEN_PRODUCT_STORAGE))},_removeExpiresLastSeenProduct:function(){var t,r;!0===localStorageHandler.exists(localStorageHandler.LAST_SEEN_PRODUCT_STORAGE)&&(t=[],r=new Date,localStorageHandler.getObject(localStorageHandler.LAST_SEEN_PRODUCT_STORAGE).forEach(function(e){new Date(e.expireDate)>r&&t.push(e)}),0!==t.length?localStorageHandler.setObject(localStorageHandler.LAST_SEEN_PRODUCT_STORAGE,t):localStorageHandler.remove(localStorageHandler.LAST_SEEN_PRODUCT_STORAGE))},__buildMarkBazaarVoice:function(e){return void 0===e?"":e},_convertUrlPictureHdToSd:function(e){return void 0===e?"":e.replace(this.__HD_PICTURE_PATTERN__,this.__SD_PICTURE_PATTERN__)},_clear:function(e){localStorageHandler.remove(localStorageHandler.LAST_SEEN_PRODUCT_STORAGE),$(e).addClass("none")}};return"undefined"!=typeof LastSeenProductCustom&&new LastSeenProductCustom(e),e._init()},LastSeenProductCustom=function(S){S.__HD_PICTURE_PATTERN__="_frf1.",S._generateDataProductPage=function(e){var t=e.find("img.current").attr("id"),r=e.find("#productName").text(),a=e.find(".partright .salePrice").text().trim(),o=e.find(".partright .lowestPrice").text().trim(),n=e.find(".coloris_section img.current").attr("role"),_=S._convertUrlPictureHdToSd(n),c=window.location.href,l=e.find("#BVRRSummaryContainer").data("rate");return{refco:t,name:r,salePrice:a,price:o,pictureUrl:_,productUrl:c,bazaarvoiceMark:S.__buildMarkBazaarVoice(l)}}};