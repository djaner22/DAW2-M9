/* uglify - 2020-11-13 11:11:02 - */
function addDeviceType(){isMobile?tc_vars.site_version="mobile":tc_vars.site_version="desktop"}function build_tc_vars(){"undefined"==typeof oUtils&&(oUtils=new Utils);var o=!1,i="fr.commande.paiement.confirmation"===tc_json_vars.page_name;$.each(tc_json_vars,function(c,e){var r,_,t=0===c.indexOf("address_ip"),s=0===c.indexOf("user_"),n=0===c.indexOf("product_color"),a=0===c.indexOf("product_size");("list_products"===c||"order_products"===c)&&0<e.length?(o||(tc_vars[c]=new Array,o=!0),r=0,$.each(e,function(e,t){tc_vars[c][r]=new Array,$.each(t,function(_,e){var s;"list_product_breadcrumb_label"===_||"order_product_breadcrumb_label"===_?(s=0,tc_vars[c][r][_]=new Array,$.each(e,function(e,t){tc_vars[c][r][_][s]=t,s+=1})):tc_vars[c][r][_]=e}),r+=1})):"product_breadcrumb_label"===c?(_=0,tc_vars[c]=new Array,$.each(e,function(e,t){tc_vars[c][_]=t,_+=1})):"page_name"===c&&"undefined"!=typeof oNewLayerLang&&oNewLayerLang._isOpened?(tc_vars[c]=e.replace("homepage","prehome"),oUtils._log("page_name")):n||a||s&&!i||t&&!i&&void 0!==tc_vars.address_ip||(tc_vars[c]=e)}),addDeviceType()}function build_tc_events_common(e,t,_,s){tc_events.action=s,tc_events.category=_,tc_events.product_category=tc_vars.page_categoryname,tc_events.product_quantity=e,tc_events.env_template=tc_vars.env_template,tc_events.env_country=tc_vars.env_country,tc_events.env_language=tc_vars.env_language,tc_events.label=tc_vars.product_trademark+"|"+tc_vars.product_name+"|"+tc_vars.product_id_refco,tc_events.address_ip=tc_vars.address_ip,tc_events.test_version=tc_vars.test_version,tc_events.page_name=tc_vars.page_name,tc_events.site_version=tc_vars.site_version,t?fillTcEventFromListObj(t):fillTcEventFromTcVars()}function fillTcEventFromTcVars(){tc_events.kb_stickers=tc_vars.kb_stickers,tc_events.product_saison=tc_vars.product_saison,tc_events.product_color=tc_vars.product_color,tc_events.product_currency=tc_vars.product_currency,tc_events.product_discount=tc_vars.product_discount,tc_events.product_discount_ati=tc_vars.product_discount_ati,tc_events.product_discount_tf=tc_vars.product_discount_tf,tc_events.product_famille=tc_vars.product_famille,tc_events.product_id=tc_vars.product_id,tc_events.product_id_refco=tc_vars.product_id_refco,tc_events.product_name=tc_vars.product_name,tc_events.product_rayon=tc_vars.product_rayon,tc_events.product_size=tc_vars.product_size,tc_events.product_sousfamille=tc_vars.product_sousfamille,tc_events.product_trademark=tc_vars.product_trademark,tc_events.product_unitprice_ati=tc_vars.product_unitprice_ati,tc_events.product_unitprice_tf=tc_vars.product_unitprice_tf,tc_events.product_univers=tc_vars.product_univers,tc_events.product_store=tc_vars.product_store,tc_events.value=tc_vars.product_unitprice_tf,tc_events.product_reco="no"}function fillTcEventFromListObj(e){tc_events.kb_stickers=oUtils._displayString(e.kb_stickers),tc_events.product_saison=e.list_product_saison,tc_events.product_color=e.list_product_color,tc_events.product_currency=e.list_product_currency,tc_events.product_discount=e.list_product_discount,tc_events.product_discount_ati=e.list_product_discount_ati,tc_events.product_discount_tf=e.list_product_discount_tf,tc_events.product_famille=e.list_product_famille,tc_events.product_id=e.list_product_id,tc_events.product_id_refco=e.list_product_id_refco,tc_events.product_name=e.list_product_name,tc_events.product_rayon=e.list_product_rayon,e.list_product_category&&(tc_events.product_category=e.list_product_category),tc_events.product_size=e.list_product_size,tc_events.product_sousfamille=e.list_product_sousfamille,tc_events.product_trademark=e.list_product_trademark,tc_events.product_unitprice_ati=e.list_product_unitprice_ati,tc_events.product_unitprice_tf=e.list_product_unitprice_tf,tc_events.product_univers=e.list_product_univers,tc_events.value=e.list_product_unitprice_tf,tc_events.product_store=e.list_product_store;tc_events.label=tc_events.product_trademark+"|"+tc_events.product_name+"|"+tc_events.product_id_refco,e.list_product_recommended?(tc_events.product_reco="yes-"+e.list_product_algorithm,void 0!==e.product_reco&&(tc_events.product_reco=e.product_reco),0<$(".popupAddArticle:visible").length?tc_events.type_ajout_panier="widget_reco_pop-up_fiche_produit":void 0!==e.type_ajout_panier?tc_events.type_ajout_panier=e.type_ajout_panier:tc_events.type_ajout_panier="widget_reco_"+tc_events.env_template):tc_events.product_reco="no"}function findTCProductByCode(t,e){if(!t)return null;var _=[];if(tc_vars&&tc_vars.list_products&&tc_vars.list_products.filter&&(_=tc_vars.list_products.filter(function(e){return e.list_product_id_refco===t})),0===_.length)return null;var s={};return Object.assign(s,_[0]),e&&(s.list_product_size=e),s}function build_tc_events_addToCart_pagelist(e,t,_){build_tc_events_addToCart(e,"page_list",findTCProductByCode(t,_))}function build_tc_events_askResetMdp_account(){tc_events.user_id=tc_vars.user_id,tc_events.user_account_id=tc_vars.user_account_id,tc_events.user_email=tc_vars.user_email,tc_events.user_logged=tc_vars.user_logged,tc_events.user_session_id=tc_vars.user_session_id,tc_events.address_ip=tc_vars.address_ip,tc_events.env_template=tc_vars.env_template,tc_events.env_channel=tc_vars.env_channel,tc_events.env_language=tc_vars.env_language,tc_events.env_country=tc_vars.env_country,tc_events.env_work=tc_vars.env_work,tc_events.page_name=tc_vars.page_name,tc_events.page_cat1=tc_vars.page_cat1,tc_events.page_cat2=tc_vars.page_cat2,tc_events.page_cat3="forgot_password",tc_events.page_cat4="",tc_events.page_error=tc_vars.page_error,tc_events.test_version=tc_vars.test_version,tc_events.site_version=tc_vars.site_version,sendGlobalTcEvents("forgot_password")}function prepare_doResetMdpEvent_account(){tc_events.category="user_account",tc_events.action="forgot_password",tc_events.label="reset_password_request",tc_events.value="",tc_events.test_version=tc_vars.test_version,tc_events.site_version=tc_vars.site_version,tc_events.address_ip=tc_vars.address_ip,tc_events.uri=location.pathname,tc_events.env_country=tc_vars.env_country,tc_events.env_language=tc_vars.env_language,tc_events.env_template=tc_vars.env_template,tc_events.page_name=tc_vars.page_name,tc_events.user_account_id=tc_vars.user_account_id,tc_events.user_amount=tc_vars.user_amount,tc_events.user_email=tc_vars.user_email,tc_events.user_firstname=tc_vars.user_firstname,tc_events.user_frequency=tc_vars.user_frequency,tc_events.user_id=tc_vars.user_id,tc_events.user_logged=tc_vars.user_logged,tc_events.user_recency=tc_vars.user_recency,tc_events.user_session_id=tc_vars.user_session_id}function build_tc_events_doResetMdp_account(){prepare_doResetMdpEvent_account(),tc_events.label="reset_password_request",sendGlobalTcEvents("event")}function build_tc_events_doResetMdpDone_account(){prepare_doResetMdpEvent_account(),tc_events.label="reset_password_validation",sendGlobalTcEvents("event")}function build_tc_events_createFid(e){tc_events.category="user_account",tc_events.action="loyalty_card_creation:".concat(e),tc_events.label=location.pathname,tc_events.value="",tc_events.test_version=tc_vars.test_version,tc_events.site_version=tc_vars.site_version,tc_events.address_ip=tc_vars.address_ip,tc_events.uri=location.pathname,tc_events.env_country=tc_vars.env_country,tc_events.env_language=tc_vars.env_language,tc_events.env_template=tc_vars.env_template,tc_events.page_name=tc_vars.page_name,tc_events.user_account_id=tc_vars.user_account_id,tc_events.user_amount=tc_vars.user_amount,tc_events.user_email=tc_vars.user_email,tc_events.user_firstname=tc_vars.user_firstname,tc_events.user_frequency=tc_vars.user_frequency,tc_events.user_id=tc_vars.user_id,tc_events.user_logged=tc_vars.user_logged,tc_events.user_recency=tc_vars.user_recency,tc_events.user_session_id=tc_vars.user_session_id,sendGlobalTcEvents("event")}function build_tc_events_addToCart_pageproduct(e,t){build_tc_events_addToCart(e,t,void 0)}function build_tc_events_addToCart_widgetReco(e,t){tc_vars.page_categoryname=t.list_product_famille,build_tc_events_addToCart(e,"widget_reco",t)}function build_tc_events_addToCart_liveSearch(e,t){tc_events.user_account_id=oUtils._displayString(tc_vars.user_account_id),tc_events.user_amount="",tc_events.user_email=oUtils._displayString(tc_vars.user_email),tc_events.user_firstname=oUtils._displayString(tc_vars.user_firstname),tc_events.user_frequency="",tc_events.user_id=oUtils._displayString(tc_vars.user_id),tc_events.user_logged=oUtils._displayString(tc_vars.user_logged),tc_events.user_recency="",tc_events.user_session_id=oUtils._displayString(tc_vars.user_session_id),tc_events.user_smb="";var _=new Map,s=buildProductData(t,0,"");for(var c in s)_[c]=s[c];build_tc_events_addToCart(e,"liveSearch",_)}function build_tc_events_addToCart(e,t,_){var s=t,c=$("#tc_event_origine").val();void 0!==c&&"widget_reco"!==t&&(s=c),tc_events.type_ajout_panier=s,"widget_reco"===t&&(tc_events.product_cross_sell_origin=void 0,"ficheproduit"===tc_vars.env_template&&tc_vars.product_trademark&&tc_vars.product_name&&tc_vars.product_id_refco&&(tc_events.product_cross_sell_origin=tc_vars.product_trademark+"|"+tc_vars.product_name+"|"+tc_vars.product_id_refco)),_&&void 0!==_.product_reco&&(tc_events.product_reco=_.product_reco),_&&void 0!==_.type_ajout_panier&&(tc_events.type_ajout_panier=_.type_ajout_panier),build_tc_events_common(e,_,"add to cart",tc_vars.page_categoryname),sendGlobalTcEvents("add_to_cart")}function build_tc_events_findInStore(e){build_tc_events_common(1,void 0,"product_availability","find_in_store:".concat(tc_vars.product_univers,"|").concat(tc_vars.product_famille)),tc_events.product_size=e,sendGlobalTcEvents("event")}function build_tc_events_viewStock(e,t){build_tc_events_common(1,findTCProductByCode(e,t),"product_availability","view_stock:".concat(tc_vars.product_univers,"|").concat(tc_vars.product_famille)),sendGlobalTcEvents("event")}function build_tc_events_viewStock_fail(e,t,_){build_tc_events_common(1,findTCProductByCode(e,t),"e-resa",_),sendGlobalTcEvents("event")}function build_tc_events_eresa(e,t,_){build_tc_events_common(1,findTCProductByCode(e,t),"e-resa","validation|"+_),tc_events.eresa_store=_,!tc_events.product_size&&t&&(tc_events.product_size=t),sendGlobalTcEvents("event")}function build_tc_events_shopZeLook_chips_appear(e){build_tc_events_common(0,void 0,"shop ze look","view:".concat(tc_vars.product_univers,"|").concat(tc_vars.product_famille)),tc_events.uri=location.pathname,tc_events.product_reco="",tc_events.nb_chips="".concat(e),sendGlobalTcEvents("event")}function build_tc_events_shopZeLook_chip_engagement(e,t){build_tc_events_common(0,void 0,"shop ze look","clic:".concat(tc_vars.product_univers,"|").concat(tc_vars.product_famille)),tc_events.uri=location.pathname,tc_events.product_cross_sell=t,tc_events.nb_chips="".concat(e),sendGlobalTcEvents("event")}function build_tc_events_shopZeLook_product_engagement(e,t,_){var s="yes-shop_ze_look:".concat(_);build_tc_events_common(0,t,"widget_reco",'personnalisation:"'.concat(s,"|type de page:").concat(tc_vars.env_template)),tc_events.uri=location.pathname,tc_events.product_cross_sell_origin=e,tc_events.product_reco=s,sendGlobalTcEvents("event")}function build_tc_events_autoSearchCompleteMobile(e,s){tc_events.address_ip=tc_vars.address_ip,tc_events.env_country=tc_vars.env_country,tc_events.env_language=tc_vars.env_language,tc_vars.env_template="recherche",tc_events.env_template=tc_vars.env_template,tc_events.test_version=tc_vars.test_version,tc_events.page_name=tc_vars.page_name,tc_events.site_version=tc_vars.site_version,tc_events.user_account_id=tc_vars.user_account_id,tc_events.user_amount="",tc_events.user_email=tc_vars.user_email,tc_events.user_firstname="",tc_events.user_frequency="",tc_events.user_id=tc_vars.user_id,tc_events.user_logged=tc_vars.user_logged,tc_events.user_recency="",tc_events.user_session_id=tc_vars.user_session_id,tc_events.user_smb="",tc_events.search_filters="",tc_events.search_keywords=e.info.keywords,tc_events.search_page_number=e.info.pageNumber,tc_events.search_results_number=e.info.numberOfProduct,tc_events.page_cat1="recherche",0<e.products.length?tc_events.page_cat2="avec résultats":tc_events.page_cat2="sans résultat",tc_events.page_cat3="",tc_events.page_cat4="",tc_events.search_redirect="",tc_events.search_recommandation=e.searchRecommandation,tc_events.search_myprevioussearch=e.searchHistory,tc_events.search_real="",tc_events.list_products=[],e.products.forEach(function(e,t){var _=buildProductData(e,t,s);tc_events.list_products.push(_)}),sendGlobalTcEvents("search")}function buildProductData(e,t,_){var s=[];return 0!==e.oPriceOverride.getAmount()?(s.list_product_discount="yes",s.list_product_unitprice_ati=e.oPriceOverride.getAmount(),s.list_product_discount_ati=(e.oPrice.getAmount()-e.oPriceOverride.getAmount()).toFixed(2),s.list_product_discount_tf=(s.list_product_discount_ati/((100+vatRate)/100)).toFixed(2)):(s.list_product_discount="no",s.list_product_unitprice_ati=e.oPrice.getAmount(),s.list_product_discount_ati="0.0",s.list_product_discount_tf="0.0"),s.list_product_unitprice_tf=(s.list_product_unitprice_ati/((100+vatRate)/100)).toFixed(2),s.list_product_id_refco=e.dto.productCode,0<e.dto.productCode.indexOf("_")?s.list_product_id=e.dto.productCode.split("_")[0]:s.list_product_id=e.dto.productCode,s.list_product_color=e.dto.colorLabel,s.list_product_idcouleur=e.dto.codeColo,s.list_product_name=e.dto.productLabel,s.list_product_position=t+1,s.list_product_rating=e.dto.rate,s.list_product_url_page=e.productUrl,s.list_product_url_picture=e.frontUrlImage,s.list_product_univers=_,s.list_product_store="web",s.list_product_trademark="KIABI",s.list_product_currency=currencyCode,s.list_product_category="",s.list_product_cross_sell_origin="",s.list_product_descriptif="",s.list_product_famille="",s.list_product_id_crossell1="",s.list_product_id_crossell2="",s.list_product_id_crossell3="",s.list_product_quantity="",s.list_product_rayon="",s.list_product_saison="",s.list_product_size="",s.list_product_sku="",s.list_product_sousfamille="",s}function sendGlobalTcEvents(e,t){var _=t||tc_events;oUtils.log_debug(e+" ="),oUtils.log_debug(_),"undefined"!=typeof tc_events_global?tc_events_global(this,e,_):oUtils.log_error("tc_events_global undefined"),tc_events=[]}function build_tc_event_checkout_validate_step(e,t,_){var s=tcVarsLoaded(),c=[];c.env_country=tc_vars.env_country,c.env_language=tc_vars.env_language,c.checkout_step=tc_vars.checkout_step=e,c.checkout_label=tc_vars.checkout_label=t,c.pagename=tc_vars.pagename=_,c.test_version=tc_vars.test_version,s&&sendGlobalTcEvents("funnel",c)}function build_tc_event_tri(e){build_tc_event_tri_with_uri(e,location.pathname)}function build_tc_event_tri_with_uri(e,t){var _=tcVarsLoaded(),s=[];s.env_country=tc_vars.env_country,s.env_language=tc_vars.env_language,s.env_template=tc_vars.env_template,s.sort_value=e,s.uri=t,s.pagename=tc_vars.page_name,s.test_version=tc_vars.test_version,s.site_version=tc_vars.site_version,_&&sendGlobalTcEvents("sort",s)}function tcVarsLoaded(){return 0<Object.keys(tc_vars).length}function build_tc_event_filter_with_uri(e,t){var _=tcVarsLoaded(),s=[],c=e.map(function(e){return e.type}).join(","),r=e.map(function(e){return e.value}).join("|"),n=e.map(function(e){return e.type+":"+e.value}).join("|"),c=c.replace("Mortar_store_filters","store");s.env_country=tc_vars.env_country,s.env_language=tc_vars.env_language,s.env_template=tc_vars.env_template,s.filter_type=c,s.filter_value=r,s.uri=t,s.pagename=tc_vars.page_name,s.label=n,s.test_version=tc_vars.test_version,s.site_version=tc_vars.site_version,_&&sendGlobalTcEvents("filter",s)}function build_tc_event_filter(e){build_tc_event_filter_with_uri(e,location.pathname)}function build_tc_events_totalLook_button_engagement(e){build_tc_events_common(0,void 0,"product_look","discover_product:".concat(tc_vars.product_univers,"|").concat(tc_vars.product_famille)),tc_events.uri=location.pathname,tc_events.list_products_look=e,sendGlobalTcEvents("event")}function build_tc_events_totalLook_product_engagement(e,t,_){var s="yes-product_look_product:".concat(_);build_tc_events_common(0,t,"product_look","complementary_product_clic:".concat(t.list_product_univers,"|").concat(t.list_product_famille)),tc_events.uri=location.pathname,tc_events.product_cross_sell_initial=e,tc_events.product_reco=s,sendGlobalTcEvents("event")}function build_tc_event_select_shipping_type(){var e=Object.assign(checkout.invoice.totalWithoutDiscount);sendGlobalTcEvents("event",{category:"funnel",action:"selected_delivery_method",label:Object.assign(checkoutState.deliveryStep.deliveryType).toString(),value:oUtils._calcVatFreePrice(e),site_version:tc_vars.site_version,address_ip:tc_vars.address_ip,uri:"/checkout/tunnel",env_country:tc_vars.env_country,env_language:tc_vars.env_language,env_template:tc_vars.env_template,pagename:"/delivery",user_account_id:tc_json_vars.user_account_id,user_email:tc_json_vars.user_email,user_id:tc_json_vars.user_id,user_logged:tc_json_vars.user_logged,user_session_id:tc_json_vars.user_session_id})}function build_tc_event_display_shipping_adress_step(){sendGlobalTcEvents("funnel",{env_country:tc_vars.env_country,env_template:tc_vars.env_template,env_language:tc_vars.env_language,env_work:tc_json_vars.env_work,checkout_step:"",checkout_label:"",pagename:"/delivery/appointment_address",site_version:tc_vars.site_version,address_ip:tc_vars.address_ip,user_account_id:tc_json_vars.user_account_id,user_email:tc_json_vars.user_email,user_id:tc_json_vars.user_id,user_logged:tc_json_vars.user_logged,user_session_id:tc_json_vars.user_session_id})}function build_tc_event_display_time_slot_delivery_step(){sendGlobalTcEvents("funnel",{env_country:tc_vars.env_country,env_template:tc_vars.env_template,env_language:tc_vars.env_language,env_work:tc_json_vars.env_work,checkout_step:"",checkout_label:"",pagename:"/delivery/appointment_date",site_version:tc_vars.site_version,address_ip:tc_vars.address_ip,user_account_id:tc_json_vars.user_account_id,user_email:tc_json_vars.user_email,user_id:tc_json_vars.user_id,user_logged:tc_json_vars.user_logged,user_session_id:tc_json_vars.user_session_id})}function build_tc_event_validate_shipping_adress_step(e){var t=e?"validated":"refused",_=Object.assign(checkout.invoice.totalWithoutDiscount);sendGlobalTcEvents("event",{category:"funnel",action:"home_delivery_appointment_status",label:t,value:oUtils._calcVatFreePrice(_),site_version:tc_vars.site_version,address_ip:tc_vars.address_ip,uri:"/checkout/tunnel",env_country:tc_vars.env_country,env_language:tc_vars.env_language,env_template:tc_vars.env_template,pagename:"/delivery/appointment_address",user_account_id:tc_json_vars.user_account_id,user_email:tc_json_vars.user_email,user_id:tc_json_vars.user_id,user_logged:tc_json_vars.user_logged,user_session_id:tc_json_vars.user_session_id})}function build_tc_voucher_cart_commons(){return{site_version:tc_vars.site_version,address_ip:tc_vars.address_ip,uri:location.pathname,env_country:tc_vars.env_country,env_language:tc_vars.env_language,env_template:tc_vars.env_template,pagename:tc_vars.page_name}}function build_tc_event_open_promo_code(e){sendGlobalTcEvents("event",Object.assign({category:"cart:promo_code",action:"opening_window",label:"",value:e},build_tc_voucher_cart_commons()))}function build_tc_event_fill_promo_code(e,t,_){sendGlobalTcEvents("event",Object.assign({category:"cart:promo_code",action:e,label:"statut:"+t,value:_},build_tc_voucher_cart_commons()))}function build_tc_event_fill_loyality_code(e,t,_){sendGlobalTcEvents("event",Object.assign({category:"cart:loyalty_code",action:e,label:"statut:"+t,value:_},build_tc_voucher_cart_commons()))}function build_tc_event_order_directly(e,t){sendGlobalTcEvents("event",{category:"order_directly",action:tc_vars.env_template+"|"+location.pathname,label:"number_of_products:"+e,value:t,site_version:tc_vars.site_version,address_ip:tc_vars.address_ip,uri:location.pathname,env_country:tc_vars.env_country,env_language:tc_vars.env_language,env_template:tc_vars.env_template,pagename:tc_vars.page_name,user_logged:tc_json_vars.user_logged})}function build_tc_event_select_size(e,t,_){var s=Object.assign({category:"product_size_selection",action:t,label:"selected_size:"+e,value:oUtils._calcVatFreePrice(_),site_version:tc_vars.site_version,address_ip:tc_vars.address_ip,uri:location.pathname,env_country:tc_vars.env_country,env_language:tc_vars.env_language,env_template:tc_vars.env_template,pagename:tc_vars.page_name,user_account_id:tc_json_vars.user_account_id,user_email:tc_json_vars.user_email,user_id:tc_json_vars.user_id,user_logged:tc_json_vars.user_logged,user_session_id:tc_json_vars.user_session_id});this.sendGlobalTcEvents("event",s)}$(document).ready(function(){switch(build_tc_vars(),tclistproductinit=!1,pageNameTag){case"viewCart":case"checkout":tc_vars.checkout_step="1",tc_vars.checkout_label="cart";break;case"confirmation":tc_vars.checkout_step="6",tc_vars.checkout_label="order"}tag_commander_files&&tag_commander_files.size&&($.ajaxSetup({cache:!0}),new Promise(function(t){var _=tag_commander_files.size,s=0;tag_commander_files.forEach(function(e){$.getScript(e).done(function(){++s===_&&t()}).fail(function(){oUtils.log_error("tag_commander failed on file "+e)})})}).then(function(){EventBus.publish("getProductDetailsOnProductPageForYandex",{object:this})}))});