/* uglify - 2020-11-02 09:11:52 - */
"use strict";function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var AutocompletionPlaces=function(){function i(e,t,n){_classCallCheck(this,i),this.autocomplete=new AutocompletionPlacesWoosmap(e,t,n)}return _createClass(i,[{key:"applyFirstResult",value:function(){this.autocomplete.applyFirstResult()}}]),i}(),AutocompletionPlacesWoosmap=function(){function i(e,t,n){_classCallCheck(this,i),_defineProperty(this,"woosmapService",null),this.element_input=e,this.successCallback=t,this.failureCallback=n,this.firstSuggestionLocation=void 0,this.woosmapService=new WoosmapService,this._bindAutocompletion(this.element_input),this.handleInputEvent()}return _createClass(i,[{key:"_bindAutocompletion",value:function(e){var n=this;e.autocomplete({minChars:2,autoSelectFirst:!0,zIndex:1000002,deferRequestBy:100,lookup:function(e,t){n.lookup(e,t)},onSelect:function(e){return n.successCallback&&n.successCallback(e.data)}})}},{key:"lookup",value:function(e,n){var i=this;this._search(e).then(function(e){var t=e.map(function(e){return{value:"".concat(e.description),data:{latitude:e.location.lat,longitude:e.location.lng}}});t.length&&(i.firstSuggestionLocation=t[0].data),n({suggestions:t})})}},{key:"handleInputEvent",value:function(){var e=this;this.element_input.on("input",function(){e.element_input.val().length<2&&(e.firstSuggestionLocation=void 0)})}},{key:"applyFirstResult",value:function(){var e,t=this.firstSuggestionLocation;t?this.successCallback(t):(e=this).lookup(this.element_input.val(),function(){e.firstSuggestionLocation?e.successCallback(e.firstSuggestionLocation):e.failureCallback("ZERO_RESULTS")}),$(".autocomplete-suggestions").hide()}},{key:"_search",value:function(n){var i=this;if(n)return new Promise(function(t,e){i.woosmapService.search(n).done(function(e){return t(e.localities)}).fail(function(){return e(i.failureCallback&&i.failureCallback())})})}}]),i}();