/* uglify - 2020-11-02 09:11:52 - */
var oMortarStoreHandler={DAYS_EXPIRATION:1,getAll:function(){if(this.isValidDate()||this.removeAll(),localStorageHandler.exists(localStorageHandler.NEAREST_STORES)){var e=localStorageHandler.getObject(localStorageHandler.NEAREST_STORES);return localStorageHandler.exists(localStorageHandler.CLICK_AND_DRIVE)&&(e=e.filter(function(e){return e.magasin.id===oClickAndDriveHandler.getStoreId()})),e}return null},setAll:function(e){var t,r,l;e&&0!==e.length?(localStorageHandler.setObject(localStorageHandler.NEAREST_STORES,e),r=(t=new Date).setDate(t.getDate()+this.DAYS_EXPIRATION),localStorageHandler.setObject(localStorageHandler.NEAREST_STORES_EXPIRATION,r),l=e.filter(function(e){return e.custom_selectedFilter}).map(function(e){return e.magasin.id}).join("."),setCookie(cookieHandler.__MORTAR_STORES_ID__,l,{domain:cookieDomain,path:"/"})):this.removeAll()},removeAll:function(){localStorageHandler.remove(localStorageHandler.NEAREST_STORES_EXPIRATION),localStorageHandler.remove(localStorageHandler.NEAREST_STORES),setCookie(cookieHandler.__MORTAR_STORES_ID__,null)},isValidDate:function(){var e=localStorageHandler.getObject(localStorageHandler.NEAREST_STORES_EXPIRATION);return e&&new Date<new Date(e)},syncStoreLocal:function(){return new Promise(function(t,r){var e,l,a,o=oMortarStoreHandler.getAll(),n=oMortarStoreHandler._getRequestMortarParams();isSearchPage?(oPageListPersistentFilter._initFilteredUrl(),t()):o&&!n?(oMortarStoreHandler.resetAll(),t()):o&&n?((e=oMortarStoreHandler.getAll())&&(l=e.map(function(e){return e.custom_selectedFilter=-1<n.indexOf(e.magasin.id),e}),oMortarStoreHandler.setAll(l)),t()):!o&&n?(a=n.split("."),(new Delivery).getInfosMagasins(a,{success:function(e){e.forEach(function(e){e.custom_selectedFilter=!0}),oMortarStoreHandler.setAll(e),t()},failure:function(e){r(e)}})):t()})},resetAll:function(){var e=this.getAll();null!=e&&(e.forEach(function(e){e.custom_selectedFilter=!1}),oMortarStoreHandler.setAll(e),setCookie(cookieHandler.__MORTAR_STORES_ID__,null))},_getRequestMortarParams:function(){return oUtils._getUrlParameter("mortar_store_filters")},_hasAtLeastOneMortarFilterSelected:function(){return void 0!==oMortarStoreHandler._getRequestMortarParams()}};