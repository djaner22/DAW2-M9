/* uglify - 2020-10-23 12:10:04 - */
$(document).ready(function(){oHomePageOrderTracking=new HomePageOrderTracking}),HomePageOrderTracking=function(){var n="disponible",o="packaging",c="shipped",d="home",l={$parentNode:$("#ot"),scope:"desktop",__init:function(){return"undefined"!=typeof HomePageOrderTrackingCustom&&new HomePageOrderTrackingCustom(this),1===this.$parentNode.length&&this.__createHomePageTrackingBlock(),this},__createHomePageTrackingBlock:function(){var e,a,r;$.cookie("HeaderInfo")&&(a=(e=$.parseJSON($.cookie("HeaderInfo"))).user_id,r=e.user_customer_number),a&&r&&(sessionStorageHandler.exists(sessionStorageHandler.ORDER_TRACKING)?l.__displayTracking(sessionStorageHandler.getObject(sessionStorageHandler.ORDER_TRACKING)):$.ajax({url:baseUrl+"/customer/orders/packages",type:"GET",data:{customerNumber:r,customerUid:a},dataType:"html",success:function(e){var a=e?JSON.parse(e):[];sessionStorageHandler.setObject(sessionStorageHandler.ORDER_TRACKING,a),l.__displayTracking(a)},error:function(e){console.log(e)}}))},__displayTracking:function(e){0<e.length&&(l.__createHomePageTrackingBlockSummary(l.$parentNode,e),l.__createHomePageTrackingBlockDetails(l.$parentNode,e),l.$parentNode.css("display","block"))},__createHomePageTrackingBlockSummary:function(e,a){var r=a.length,t=(this.__findFirstName(),$("<input>",{id:"ot_collapsible",class:"ot_toggle",type:"checkbox"})),i=$("<label>",{id:"ot_message",for:"ot_collapsible"}),s=$("<span>",{id:"ot_message_content"}),n=$("<img>",{id:"ot_logo",src:"/template-resources/images/picto.png"});s.append(n);var o=l.__findStatus(a[0].status),c=this.__buildSummaryMessage(r,o);s.append(c),i.append(s),e.append(t),e.append(i)},__findStatus:function(e){return"orderStatus.DP"===e?n:"orderStatus.EL"===e?c:"orderStatus.EP"===e?o:void 0},__findPointType:function(e){return"POSTOFFICE"===e?"point":"STORE"===e?"store":d},__buildSummaryMessage:function(e,a){var r=this.__findFirstName();return"<span>"+$.i18n.printf($.i18n._("orderSuivi.homePage.message."+l.scope)).replace("{firstName}",r).replace("{numberOfTrackings}",e).replace("{status}",$.i18n._("orderSuivi.homePage.status."+a))+"</span>"},__createHomePageTrackingBlockDetails:function(e,a){var s=$("<div>",{class:"ot_details_inner"}),r=$("<div>",{id:"ot_details"}),n=$("<span>",{}).append($("<a>",{href:baseUrl+"/customer/orders",text:$.i18n._("orderSuivi.homePage.seeAllOrdersLink")})),o=$("<div>",{class:"ot_separator"});a.forEach(function(e,a,r){var t=$("<div>",{class:"ot_track_details"}),i=l.__buildDetailsMessage(e);t.append(i),t.append(n.clone()),s.append(t),1<r.length&&a!==r.length-1&&s.append(o.clone())}),r.append(s),e.append(r)},__buildDetailsMessage:function(e){var a=l.__findStatus(e.status),r=l.__findPointType(e.pointType),t="";switch(a){case n:t=$.i18n._("orderSuivi.homePage.trackDetailMessage."+a+"."+r+".desktop.1").replace("{orderNumber}",e.orderNumber).replace("{place}",e.withdrawalPlace.location).replace("{withdrawalLimitDate}",e.withdrawalLimitDate);break;case c:case o:t=$.i18n._("orderSuivi.homePage.trackDetailMessage."+a+".desktop").replace("{orderNumber}",e.orderNumber).replace("{statusDate}",e.statusDate)}var i,s="";return s=a!==n?(i=r===d?e.withdrawalPlace.city:e.withdrawalPlace.location,$.i18n._("orderSuivi.homePage.trackDetailMessage.shipPlace."+r+".desktop").replace("{0}",i)):$.i18n._("orderSuivi.homePage.trackDetailMessage."+a+"."+r+".desktop.2").replace("{place}",e.withdrawalPlace.location).replace("{withdrawalLimitDate}",e.withdrawalLimitDate),l.__spanifyMessage(t,s)},__spanifyMessage:function(e,a){return"<span>"+e+" "+a+"</span>"},__findFirstName:function(){var e,r="";return null!=$.cookie("HeaderInfo")&&(e=jQuery.parseJSON($.cookie("HeaderInfo")),$.each(e,function(e,a){"fistName"==e&&(r=a)})),r}};return l.__init()};