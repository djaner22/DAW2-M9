/* uglify - 2020-11-02 09:11:52 - */
EventBus.subscribe("DeleteWishlistItem","onDeleteWishlistItem",function(i){var t,s=i.origin,e=i.skuCode;"wishlist"!==s||0<(t=$('.wishListItem[data-sku="'+e+'"]').find(".wl_supp")).length&&oWishlist._deleteArticle(t)}),Wishlist=function(){var a={$wishlist:$("#wishlist"),$saveWishlist:$("#saveWishlist"),$hide_wishlist:$("#hide_wishlist"),_init:function(){return a._initEvent(),a._refreshList(!1,!1),a._getCsrfToken(),this.$hide_wishlist.css("display","none"),$("#wishlist #addAll").click(function(){a._addAllToBasket($(this))}),"true"!==this.$saveWishlist.attr("data-log")&&"logged"!==$("#customerName").data("islogged")||(this.$saveWishlist.hide(),this.$wishlist.find("p.astuce").hide()),this.$saveWishlist.click(function(){return"true"!=$(this).attr("data-log")?(stemp=$.i18n._("cart.login.popup").replace("[gotoCreateAccount]",baseUrl+"/customer/create?spring-security-redirect="+oUtils._URLEncode(absoluteUrl.substring(0,absoluteUrl.length-1)+$(this).attr("href"))),stemp=stemp.replace("[gotoInMyAccount]",$(this).attr("href")),$("#popuplogin").html(stemp),$.colorbox({width:"450px",inline:!0,href:"#popuplogin"})):document.location.href=$(this).attr("href"),!1}),$("#shareWishlist").click(function(i){$("#linkShareWishlist").removeClass("none"),$("#contentShareWishlist").find(".info").removeClass("none")}),a.getUrlWishlistShare(),$(".header-right .wl-link").removeClass("notif"),this},getUrlWishlistShare:function(){$.ajax({type:"GET",url:baseUrl+"/cart/shareWishlist.ep",success:a.shareWishlistCallback})},shareWishlistCallback:function(i){$("#linkShareWishlist").html(i)},_initVisualLoading:function(){$("#wishlistloader").css("display","block"),this.$hide_wishlist.css({width:this.$wishlist.innerWidth(),height:this.$wishlist.innerHeight(),display:"block"})},_initVisualLoaded:function(){$("#wishlistloader,#hide_wishlist").css("display","none")},_initEvent:function(){this.$wishlist.find(".wl_add").one("click",function(){a._addToBasket($(this))}),this.$wishlist.find(".wl_supp").one("click",function(){a._deleteArticle($(this))})},_getCsrfToken:function(){this.$wishlist.each(function(i,t){$.ajax({type:"post",async:!1,url:baseUrl+"/product/get-token",data:{csrfTokenKey:"/wish/add_wl"+i},dataType:"text",success:function(i){$(t).find(".csrfToken").val(i)},error:function(i,t){oUtils._log("ERROR: "+t+":"+i.responseText)}})})},_deleteArticle:function(i){var t=i.parents(".form");a._initVisualLoading();var s=t.find("input[name='skuCode']").attr("value"),e=t.find("input[name='csrfToken'][data-flag='cart']").attr("value"),n=oUtils._getCookieValue("nshop"),o=new oUtils._SingleConstituentShoppingItemDto(s,1,e,n),l=JSON.stringify(o);$.ajax({type:"POST",url:baseUrl+"/cart/delete_wl_item",data:l,contentType:"application/json",success:function(){0<nbArticlesWishList&&nbArticlesWishList--,a._refreshList(!0)}})},_addToBasket:function(i){oParentForm=i.parents(".form"),a._initVisualLoading();var t=oParentForm.find("input[name='skuCode']").attr("value"),s=$("#wishlist input[name='csrfToken']").attr("value"),e=oUtils._getCookieValue("nshop"),n=new oUtils._SingleConstituentShoppingItemDto(t,1,s,e),o=JSON.stringify(n);$.ajax({type:"POST",url:baseUrl+"/cart/wl_to_cart",data:o,contentType:"application/json",success:function(){i.parents("form").css("display","none"),nbArticlesWishList--,nbArticlesPanier++,cookieHandler.updateHeaderInfo(!0,!0,isModeLight),a._refreshList(!0,!0),oCommand.refreshCommand()}})},_addAllToBasket:function(i){oParentForm=i.parents("form"),a._initVisualLoading(),$.ajax({type:"POST",url:baseUrl+"/cart/wl_to_cart_all",success:function(){i.parents("form").css("display","none"),nbArticlesPanier+=nbArticlesWishList,nbArticlesWishList=0,oCommand.refreshCommand(),a._refreshList(!0)}})},_refreshList:function(s,e){a._initVisualLoading(),isModeLight||setCookie("HeaderInfo",null),$.ajax({type:"GET",url:baseUrl+"/cart/get_wishlist.ep",success:function(i){$(".wishlist").html($(i).find(".wishlist").html()),a._initVisualLoaded(),a._initEvent(),cookieHandler.updateHeaderInfo(!1,!1,isModeLight),0<a.$wishlist.find(".wishlist li.wishListItem").size()?(a.$wishlist.css("display","block"),$("#nowishlist").css("display","none")):(a.$wishlist.css("display","none"),$("#nowishlist").css("display","block"));var t=document.location.href.indexOf("save");t<0&&(t=document.location.href.indexOf("#wishlist")),!0===s?(positionwhist=$("#reloadajaxcommand").position(),null!=positionwhist&&(posFormTop=positionwhist.top,$("html,body").delay(1).animate({scrollTop:posFormTop}))):(0<t||e)&&(positionwhist=a.$wishlist.position(),posFormTop=positionwhist.top+100,$("html,body").delay(100).animate({scrollTop:posFormTop}))}})}};return a._init()},$(document).ready(function(){oWishlist=new Wishlist});